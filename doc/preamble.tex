
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{amsmath,amssymb,paralist,stmaryrd,mathpartir,mathtools,tabularx,xcolor,centernot,tabto}
\usepackage{tocloft}

\usepackage[backend=bibtex,maxbibnames=100]{biblatex}

\usepackage{makeidx}\makeindex
\usepackage[font=footnotesize,labelfont=bf]{caption}
\usepackage{graphicx}
\usepackage[section]{placeins}
\usepackage{idxlayout}
\usepackage{yfonts}
\usepackage{listings}
\usepackage{longtable}
\usepackage{declmath}
\usepackage{version}
\usepackage{xr}
\usepackage[framemethod=tikz]{mdframed}
% don't load geometry if preview is to be loaded
% (the ifx-statement detects \PassOptionsToPackage{preview}{...})
\expandafter\ifx\csname opt@preview.sty\endcsname\relax
\usepackage[a4paper,margin=1in]{geometry}
\fi
\usepackage[users=Q]{uchanges}
\usepackage{circuits}
\ChangesSetUserColor[Dominique]{Q}{red}
\ChangesSetUserColor[Reviewer]{R}{invalid}
\usepackage[pdfborderstyle={/S/U/W 0.3}]{hyperref}
\usepackage[delaytext,envcountsame,multiautoref]{latexhacks}

\usetikzlibrary{decorations.pathreplacing}

\lstdefinelanguage{qrhl}{
  morekeywords={vars,inner,calls,if,then,else,local,isabelle,classical,var,quantum,program,qrhl,lemma,qed,ambient,include,call,adversary,measure,with,inline,simp,wp,conseq,post,rule,skip},
  sensitive=true,
  commentstyle=\empty,
  extendedchars=false,
  string=[b]",
  stringstyle=\ttfamily,
  escapeinside=\^^A\^^B,
  %backgroundcolor=\color{gray!10},
  numbers=left,
  numbersep=5pt,
  numberstyle=\tiny\color{gray}
}

\lstdefinelanguage{isabelle}{
  morekeywords={axiomatization,where,simp,and,definition},
  sensitive=true,
  extendedchars=false,
  commentstyle=\empty,
  escapeinside=\^^A\^^B,
  %backgroundcolor=\color{gray!10},
  numbers=left,
  numbersep=5pt,
  numberstyle=\tiny\color{gray}
}

\DeclareUnicodeCharacter{2265}{\ensuremath{\geq}}
\DeclareUnicodeCharacter{27F7}{\ensuremath{\longleftrightarrow}}
\DeclareUnicodeCharacter{22C3}{\ensuremath{\bigcup}}
\DeclareUnicodeCharacter{2A06}{\ensuremath{\bigsqcup}}
\DeclareUnicodeCharacter{27F9}{\ensuremath{\Longrightarrow}}
\DeclareUnicodeCharacter{212D}{\ensuremath{\mathfrak C}}
\DeclareUnicodeCharacter{1D529}{\ensuremath{\mathfrak l}}
\DeclareUnicodeCharacter{1D51E}{\ensuremath{\mathfrak a}}
\DeclareUnicodeCharacter{1D52E}{\ensuremath{\mathfrak q}}
\DeclareUnicodeCharacter{2260}{\ensuremath{\neq}}
\DeclareUnicodeCharacter{3BB}{\ensuremath{\lambda}}
\DeclareUnicodeCharacter{2293}{\ensuremath{\sqcap}}
\DeclareUnicodeCharacter{27E6}{\ensuremath{\llbracket}}
\DeclareUnicodeCharacter{301A}{\ensuremath{\llbracket}}
\DeclareUnicodeCharacter{27E7}{\ensuremath{\rrbracket}}
\DeclareUnicodeCharacter{301B}{\ensuremath{\rrbracket}}
\DeclareUnicodeCharacter{2297}{\ensuremath{\otimes}}
\DeclareUnicodeCharacter{22C5}{\ensuremath{\cdot}}
\DeclareUnicodeCharacter{B7}{\ensuremath{\cdot}}
\DeclareUnicodeCharacter{BB}{\text\guillemotright}
\DeclareUnicodeCharacter{2227}{\ensuremath{\land}}
\DeclareUnicodeCharacter{2261}{\ensuremath{\equiv}}
\DeclareUnicodeCharacter{2208}{\ensuremath\in}
\DeclareUnicodeCharacter{2264}{\ensuremath\leq}
\DeclareUnicodeCharacter{2228}{\ensuremath\vee}
\DeclareUnicodeCharacter{2200}{\ensuremath\forall}
\DeclareUnicodeCharacter{22A5}{\ensuremath\bot}
\DeclareUnicodeCharacter{AC}{\ensuremath\lnot}
\DeclareUnicodeCharacter{2286}{\ensuremath\subseteq}
\DeclareUnicodeCharacter{2209}{\ensuremath\notin}
\DeclareUnicodeCharacter{21D2}{\ensuremath\Rightarrow}
\DeclareUnicodeCharacter{3B4}{\ensuremath\delta}
\DeclareUnicodeCharacter{27F6}{\ensuremath\rightarrow}

\newcommand\mytilde{\raise.17ex\hbox{$\scriptstyle\sim$}}


\makeatletter



%\hyphenation{proof-script}

\input{macros}
%\input{pastebin}

\sloppy


\DeclareUnicodeCharacter{212D}{\textswab C}
\DeclareUnicodeCharacter{1D529}{\textswab l}
\DeclareUnicodeCharacter{1D51E}{\textswab a}
\DeclareUnicodeCharacter{2260}{\ensuremath{\neq}}
\DeclareUnicodeCharacter{27E6}{\ensuremath{\llbracket}}
\DeclareUnicodeCharacter{27E7}{\ensuremath{\rrbracket}}
\DeclareUnicodeCharacter{2297}{\ensuremath{\otimes}}
\DeclareUnicodeCharacter{22C5}{\ensuremath{\cdot}}
\DeclareUnicodeCharacter{2264}{\ensuremath{\leq}}
\DeclareUnicodeCharacter{2293}{\ensuremath{\sqcap}}

\hyphenation{Isa-belle}
\hyphenation{Isa-belle/HOL}


\lstset{
  basicstyle=\small\ttfamily,
  literate={~} \mytilde {1},
  breaklines=true,
  escapeinside=\^^A\^^B,
}

\makeatletter

\DeclareCaptionFormat{myformat}{#1#2#3\leavevmode\leaders\hrule height .1pt\hfill\kern\z@}
\captionsetup[figure]{format=myformat}


%\fullshort{
\renewcommand\sectionautorefname{Section}
\renewcommand\subsectionautorefname{Section}
\renewcommand\subsubsectionautorefname{Section}
\newcommand\lemmaautorefname{Lemma}
\newcommand\conjectureautorefname{Conjecture}
\newcommand\definitionautorefname{Definition}
\newcommand\corollaryautorefname{Corollary}
\newcommand\claimautorefname{Claim}
% }{
% \renewcommand\sectionautorefname{Sec.}
% \renewcommand\subsectionautorefname{Sec.}
% \renewcommand\subsubsectionautorefname{Sec.}
% \renewcommand\theoremautorefname{Thm.}
% \newcommand\lemmaautorefname{Lemma}
% \newcommand\conjectureautorefname{Conjecture}
% \newcommand\definitionautorefname{Def.}
% \newcommand\corollaryautorefname{Coro.}
% \newcommand\claimautorefname{Claim}
% }


\mdfdefinestyle{theoremstyle}{%
  linecolor=black,
  backgroundcolor=black!10!white,
  frametitlebelowskip=0pt,
  innerleftmargin=5pt,
  innerrightmargin=5pt,
}

\mdtheorem[style=theoremstyle]{definition}{Definition}
\mdtheorem[style=theoremstyle]{lemma}{Lemma}
\mdtheorem[style=theoremstyle]{corollary}{Corollary}


\newtheorem{theorem}{Theorem}
\newtheorem{conjecture}{Conjecture}

\newcounter{claimstep}
\newtheorem{claim}{Claim}[claimstep]
\renewcommand\theclaim{\arabic{claim}}


\newcommand\toolidx[1]{\index{#1@\textttOLD{#1} (tool command)}}


\AtBeginDocument{
  \ifx\PreviewMacro\undefined\else
  \PreviewEnvironment*{figure}
  \PreviewMacro*\footnote
  \PreviewMacro[!]\boardpic
  \PreviewMacro*\lstinputlisting
  \PreviewMacro[{[]{}{}{}}]\RULE
  \fi}

\bibliography{qrhl}


\newcommand\PROOFREAD[1]{\TODOQ{proofread\ifx!#1!\else #1\fi}}
%\renewcommand\PROOFREAD[1]{}

\newcommand\giturl[1]{\url{https://raw.githubusercontent.com/dominique-unruh/qrhl-tool/master/#1}}

\newenvironment{citemize}{\begin{itemize}}{\end{itemize}}

\allowdisplaybreaks


\externaldocument[main:]{qrhl}

\newcommand\qrhlautoref[1]{\autoref*{main:#1} in~\cite{qrhl-paper-from-manual}}
\newcommand\qrhlautorefx[1]{\autoref*{main:#1}}

\renewcommand\refrule[1]{\hbox{\textsc{#1}} rule}
\renewcommand\ruleref[1]{rule \hbox{\textsc{#1}}}
\renewcommand\rulerefx[1]{\hbox{\textsc{#1}}}
\renewcommand\Ruleref[1]{Rule \hbox{\textsc{#1}}}
